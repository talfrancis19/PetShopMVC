@model Animal
@{
    ViewData["Title"] = "Details";
    var categoryName = ViewData["CategoryName"];
    var comments = (List<string>)ViewData["Comments"];
}

<h1 style="text-align:center">Pet Details:</h1>
<div>
    Pet Image
</div>

<td>
    <img style="width: 200px ;height: 200px; object-fit: cover;" src="/Images/@Model.ImageFileName" alt="Animal Image" class="animal-image">
</td>

<div>
    <dl class="row">
        <dt class="col-sm-2">
            @Html.DisplayNameFor(model => model.Name)
        </dt>
        <dd class="col-sm-10">
            @Html.DisplayFor(model => model.Name)
        </dd>
        <dt class="col-sm-2">
            @Html.DisplayNameFor(model => model.Age)
        </dt>
        <dd class="col-sm-10">
            @Html.DisplayFor(model => model.Age)
        </dd>
        <dt class="col-sm-2">
            @Html.DisplayNameFor(model => model.Description)
        </dt>
        <dd class="col-sm-10">
            @Html.DisplayFor(model => model.Description)
        </dd>
        <dt class="col-sm-2">
            Category
        </dt>
        <dd class="col-sm-10">
            @categoryName
        </dd>
    </dl>
</div>
<div>
    <table class="table table-dark table-striped">
        <thead>
            <tr>
                <th>Comments:</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var comment in comments)
            {
                <tr>
                    <td>@comment</td>
                </tr>
            }
        </tbody>
    </table>
</div>

<div>
    <h4>Add a Comment:</h4>
    <div class="form-group">
        <input type="text" id="commentInput" class="form-control" placeholder="Enter your comment">
    </div>
    <div style="height: 40px; padding-top:12px" class="form-group">
        <button type="button" class="btn btn-primary" id="postCommentButton">Post Comment</button>
    </div>
</div>

@section Scripts {
    <script>
        $(function () {
            $('#postCommentButton').click(function () {
                var commentText = $('#commentInput').val();
                if (commentText) {
                    $.post('/Comments/AddComment', { animalId: @Model.AnimalId, commentText: commentText })
                        .done(function () {
                            // Reload the page to update the comments
                            location.reload();
                        })
                        .fail(function () {
                            alert('Failed to add the comment. Please try again.');
                        });
                } else {
                    alert('Please enter a comment.');
                }
            });
        });
    </script>
}
